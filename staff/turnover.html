<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>方向幕 プッシュ切り替え</title>
  <style>
    .container {
      position: relative;
      width: 600px;
      height: 200px;
      margin: 20px auto;
      overflow: hidden; /* はみ出しを隠す */
      border: 2px solid #333;
    }
    .slide {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      transition: transform 1s ease;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h2>方向幕 プッシュ切り替え</h2>
  <div class="container">
    <img id="rollsign" class="slide" src="assets/images/to/TO1.png" alt="方向幕">
  </div>

  <div>
    <label>停止番号: <input type="number" id="stopIndex" value="5" min="1"></label>
    <button onclick="startAutoScroll()">▶ 自動スクロール開始</button>
    <button onclick="stopAutoScroll()">■ 停止</button>
  </div>

  <script>
    const totalImages = 10;
    const basePath = "assets/images/to/";
    const images = [];
    for (let i = 1; i <= totalImages; i++) {
      images.push(`${basePath}TO${i}.png`);
    }

    let currentIndex = 0;
    let scrollTimer = null;
    const container = document.querySelector(".container");
    let currentSlide = document.getElementById("rollsign");

    function pushImage(index) {
      // 新しい画像を作成
      const newSlide = document.createElement("img");
      newSlide.src = images[index];
      newSlide.className = "slide";
      newSlide.style.transform = "translateY(100%)"; // 下から入ってくる
      container.appendChild(newSlide);

      // アニメーション開始
      requestAnimationFrame(() => {
        // 現在の画像は上へ押し出される
        currentSlide.style.transform = "translateY(-100%)";
        // 新しい画像は中央へ
        newSlide.style.transform = "translateY(0)";
      });

      // アニメーション終了後に古い画像を削除
      setTimeout(() => {
        container.removeChild(currentSlide);
        currentSlide = newSlide;
      }, 1000); // transition時間と合わせる
    }

    function nextImage() {
      currentIndex = (currentIndex + 1) % images.length;
      pushImage(currentIndex);
    }

    function startAutoScroll() {
      stopAutoScroll();
      const stopIndex = parseInt(document.getElementById("stopIndex").value, 10) - 1;
      scrollTimer = setInterval(() => {
        nextImage();
        if (currentIndex === stopIndex) {
          stopAutoScroll();
        }
      }, 2500);
    }

    function stopAutoScroll() {
      if (scrollTimer) {
        clearInterval(scrollTimer);
        scrollTimer = null;
      }
    }
  </script>
</body>
</html>
