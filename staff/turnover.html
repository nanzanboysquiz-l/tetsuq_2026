<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>方向幕 プッシュ切り替え 等速スクロール</title>
  <style>
    .container {
      position: relative;
      width: 600px;
      height: 200px;
      margin: 20px auto;
      overflow: hidden; /* はみ出しを隠す */
      border: 2px solid #333;
    }
    .slide {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      transition: transform 1s linear; /* 等速で動く */
    }
  </style>
</head>
<body>
  <h2>方向幕 プッシュ切り替え（等速スクロール）</h2>
  <div class="container">
    <img id="rollsign" class="slide" src="assets/images/to/TO1.png" alt="方向幕">
  </div>

  <div>
    <label>停止番号: <input type="number" id="stopIndex" value="5" min="1"></label>
    <button onclick="startScroll()">▶ 再生開始</button>
  </div>

  <script>
    const totalImages = 10; // 画像枚数
    const basePath = "assets/images/to/";
    const images = [];
    for (let i = 1; i <= totalImages; i++) {
      images.push(`${basePath}TO${i}.png`);
    }

    let currentIndex = 0;
    const container = document.querySelector(".container");
    let currentSlide = document.getElementById("rollsign");

    // プッシュ切り替え
    function pushImage(index) {
      const newSlide = document.createElement("img");
      newSlide.src = images[index];
      newSlide.className = "slide";
      newSlide.style.transform = "translateY(100%)"; // 下から入る
      container.appendChild(newSlide);

      // アニメーション開始
      requestAnimationFrame(() => {
        currentSlide.style.transform = "translateY(-100%)"; // 上へ押し出す
        newSlide.style.transform = "translateY(0)";
      });

      // アニメーション終了後に古い画像を削除
      setTimeout(() => {
        container.removeChild(currentSlide);
        currentSlide = newSlide;
      }, 1000); // transition時間と合わせる
    }

    // 等速で指定番号まで進む
    function scrollTo(stopIndex) {
      if (currentIndex === stopIndex) return; // 到達したら終了
      currentIndex = (currentIndex + 1) % images.length;
      pushImage(currentIndex);
      setTimeout(() => scrollTo(stopIndex), 1500); // 等速で次へ
    }

    function startScroll() {
      const stopIndex = parseInt(document.getElementById("stopIndex").value, 10) - 1;
      scrollTo(stopIndex);
    }
  </script>
</body>
</html>
